import logging;reload(logging)
FORMAT="%(asctime)-8s%(message)s"
logging.basicConfig(format=FORMAT, filename="testlog.log", level=logging.DEBUG)

logging.info("=====Uploading first set of custom assets=====")

sleep(2)
openApp("C:\Users\Vincent\AppData\Local\Tygron Engine Test\Tygron Engine Test.exe")
wait("1458739770583.png",10)
dragDrop(Pattern("1459518307992.png").targetOffset(261,-121),Pattern("1459518307992.png").targetOffset(-268,-122))
type(Key.BACKSPACE)
paste(Pattern("1458739802503.png").targetOffset(-3,-122),"qaautotest1@tygron.com")
paste(Pattern("1458739802503.png").targetOffset(-4,-64),"autotest1qa")
click(Pattern("1458739802503.png").targetOffset(-6,47))
wait("1460630949878.png",30)
click()
wait("1458740074669.png")
paste(Pattern("1458740108957.png").targetOffset(-25,-219),"SikuliX-Asset_Test")
click(Pattern("1458740074669-1.png").targetOffset(228,12))
if not exists("1459768679923.png", 10):
    print"[error] Map selection panel not found!"
    logging.error("[error] Map selection panel not found!")
    exit(1)
click(Pattern("1459768823675.png").targetOffset(426,261))
click(Pattern("1459768823675.png").targetOffset(421,302))
if not exists("1458740747736.png", 15):
    print("[error] The project was not created as expected!")
    logging.error("[error] The project was not created as expected!")
    exit(1)
else:
    print("[success] An empty map has been created!")
    logging.info("[success] An empty map has been created!")

click("1460467075162.png")
click("1459769534717.png")
click(Pattern("1459853297207.png").targetOffset(-52,-102))
if not exists("1459851885184.png", 10):
    print"[error] Stakeholder creation failed!"
    logging.error("[error] Stakeholder creation failed!")
    exit(1)
click("1459851885184.png")
wait("1459851900025.png", 10)
#click(Pattern("1459851922961.png").targetOffset(-25,-4))
click(Pattern("1459853056056.png").targetOffset(91,1))
wait("1459853632772.png", 10)

click("1459851900025.png")
wait("1459769727355.png", 15)
click(Pattern("1459769727355.png").targetOffset(-173,205))
wait("1459769876588.png", 10)
click(Pattern("1459769876588.png").targetOffset(-16,-216))
#dragDrop(Pattern("1459769876588.png").targetOffset(145,-215), Pattern("1459769876588.png").targetOffset(-321,-217))
paste("C:\Users\Vincent\Desktop\AssetTest-0331\Origineel")
type(Key.ENTER)
click("1459770174480.png")
click("1460559214267.png")
wait("1459770363840.png", 10)
click(Pattern("1459770363840.png").targetOffset(33,-179))
click(Pattern("1459770363840.png").targetOffset(99,263))
if not exists("1459770523662.png", 15):
    print("[error] The custom stakeholder image was not added as expected!")
    logging.error("[error] The custom stakeholder image was not added as expected!")
    exit(1)
else:
    print("[success] The custom stakeholder image was successfully added!")
    logging.info("[success] The custom stakeholder image was successfully added!")
click("1459771132666.png")
wait(Pattern("1459853896819.png").similar(0.60), 10)
click(Pattern("1459853896819.png").targetOffset(-120,424))
click(Pattern("1459848362809-1.png").similar(0.91).targetOffset(3,-12))
wait("1459846230905-1.png", 5)
click(Pattern("1459846230905-1.png").targetOffset(-7,-288))
wait("1459771232817.png", 5)
click(Pattern("1459771232817.png").targetOffset(-175,204))
wait(Pattern("1459769876588.png").similar(0.61), 10)
#click(Pattern("1459769876588.png").targetOffset(-16,-216))
#dragDrop(Pattern("1459769876588.png").targetOffset(145,-215), Pattern("1459769876588.png").targetOffset(-321,-217))
#paste("C:\Users\Vincent\Desktop\AssetTest-0331\Origineel")
#type(Key.ENTER)
click("1459771356632.png")
click("1460559214267.png")
click(Pattern("1459771410536.png").targetOffset(2,-183))
click(Pattern("1459771410536.png").targetOffset(100,263))
if not exists("1459771948916.png", 15):
    print("[error] The custom action menu image was not added as expected!")
    logging.error("[error] The custom action menu image was not added as expected!")
    exit(1)
else:
    print("[success] The custom action menu image was successfully added!")
    logging.info("[success] The custom action menu image was successfully added!")
click("1459772458832.png")
click(Pattern("1459772488448.png").targetOffset(-121,32))
click("1459772511359.png")
click("1459772526959.png")
wait("1459772553096.png", 5)
click(Pattern("1459772553096.png").targetOffset(-175,205))
wait(Pattern("1459769876588.png").similar(0.64), 10)
click("1460453120142.png")
click("1460559214267.png")
wait("1459772734798.png", )
click(Pattern("1459772734798.png").targetOffset(13,-192))
click(Pattern("1459772734798.png").targetOffset(99,251))
if not exists("1459772809263.png", 15):
    print("[error] The custom measure image was not added as expected!")
    logging.error("[error] The custom measure image was not added as expected!")
    exit(1)
else:
    print("[success] The custom measure image was successfully added!")
    logging.info("[success] The custom measure image was successfully added!")
click("1459773712671.png")
click("1459773830726.png")
wait("1459855144970.png")
click(Pattern("1459855144970.png").targetOffset(74,4))
wait("1459842846848.png", 5)
click(Pattern("1459842846848.png").targetOffset(13,-192))
click(Pattern("1459842846848.png").targetOffset(98,248))
if not exists("1459774972638.png", 15):
    print("[error] The custom function value image was not added as expected!")
    logging.error("[error] The custom function value image was not added as expected!")
    exit(1)
else:
    print("[success] The custom function value image was successfully added!")
    logging.info("[success] The custom function value image was successfully added!")
click(Pattern("1459775234613.png").targetOffset(369,-289))
click("1459855641669.png")
click("1459846090209.png")
click(Pattern("1460016692300.png").targetOffset(-81,19))
click("1459849467106.png")
click(Pattern("1459846596534.png").targetOffset(-25,-4))
click("1459846751060.png")
click("1459849139235.png")
click("1459846783164.png")
click("1459846801644.png")
click("1459846815428-1.png")
wait("1459847000228-1.png", 10)
dragDrop(Pattern("1459847000228-1.png").targetOffset(-94,-188), Pattern("1459847000228-1.png").targetOffset(-93,118))
click("1459847162665-1.png")
dragDrop(Pattern("1459850042214.png").targetOffset(201,-156), Pattern("1459850042214.png").targetOffset(199,-20))
if not exists("1459855338816.png"):
    print"[error] Can't find construction!"
    logging.error("[error] Can't find construction!")
    exit(1)
click("1459855338816.png")
click("1459850540945.png")
if not exists("1459855388887.png", 10):
    print"[error] Image not displayed as expected!"
    logging.error("[error] Image not displayed as expected!")
    
click("1460621714063.png")
dragDrop("1459847710221.png", "1459847713459.png")
click(Pattern("1459847743725.png").targetOffset(-3,13))
click(Pattern("1459854928035.png").similar(0.65).targetOffset(-519,-94))
wait("1459847819158.png", 5)
click(Pattern("1459847819158.png").targetOffset(54,181))
click("1459847874509.png")
click(Pattern("1459847894261.png").targetOffset(86,-186))
click("1459854553718.png")
if not exists("1459854596405.png"):
    print"[error] Custom image for measure failed when executing measure!"
    logging.error("[error] Custom image for measure failed when executing measure!")
    exit(1)
click(Pattern("1459854703188.png").targetOffset(251,88))
click("1459847914820.png")
click("1460622295579.png")
click("1459775456044.png")
wait("1459775480289.png")
click(Pattern("1459775480289.png").targetOffset(8,400))
click(Pattern("1459775586322.png").targetOffset(5,79))
click(Pattern("1459775615298.png").targetOffset(-127,-1))
wait("1459775649066.png")
click(Pattern("1459775649066.png").targetOffset(-3,-34))
wait("1459776109999.png",10)
click("1459776109999.png")
wait("1459775709769.png")
click(Pattern("1459775709769.png").targetOffset(-179,206))
wait(Pattern("1459769876588.png").similar(0.61), 10)
#click(Pattern("1459769876588.png").targetOffset(-16,-216))
#dragDrop(Pattern("1459769876588.png").targetOffset(145,-215), Pattern("1459769876588.png").targetOffset(-321,-217))
#paste("C:\Users\Vincent\Desktop\AssetTest-0331\Origineel")
#type(Key.ENTER)
click("1460455608235.png")
click("1460559214267.png")
click(Pattern("1459777670420.png").targetOffset(34,-138))
click(Pattern("1459777670420.png").targetOffset(98,260))
if not exists("1459777753539.png", 15):
    print("[error] The custom overlay image was not added as expected!")
    logging.error("[error] The custom overlay image was not added as expected!")
    exit(1)
else:
    print("[success] The custom overlay image was successfully added!")
    logging.info("[success] The custom overlay image was successfully added!")
click("1460472513836.png")

click("1459778258791.png")
click("1459778276391.png")
click("1459778311279.png")
wait("1459779320289.png", 5)
click(Pattern("1459779320289.png").targetOffset(-81,-87))
click(Pattern("1459779564558.png").targetOffset(-126,35))
wait("1459778396254.png", 5)
click("1459778406855.png")
click(Pattern("1459778424800.png").targetOffset(-2,4))
wait("1459769876588.png", 10)
#click(Pattern("1459769876588.png").targetOffset(-16,-216))
#dragDrop(Pattern("1459769876588.png").targetOffset(145,-215), Pattern("1459769876588.png").targetOffset(-321,-217))
#paste("C:\Users\Vincent\Desktop\AssetTest-0331\Origineel")
#type(Key.ENTER)
click("1459778481462.png")
click(Pattern("1459778534814.png").targetOffset(250,202))
if not exists("1459778582109.png", 15):
    print("[error] The excel indicator file was not added as expected!")
    logging.error("[error] The excel indicator file was not added as expected!")
    exit(1)
else:
    print("[success] The excel indicator file was successfully added!")
    logging.info("[success] The excel indicator file was successfully added!")
click("1460622747536.png")
if not exists("1459778707780.png", 15):
    print("[error] The excel indicator file output is not as expected!")
    logging.error("[error] The excel indicator file output is not as expected!")
    #exit(1)
else:
    print("[success] The excel indicator file shows the correct output!")
    logging.info("[success] The excel indicator file shows the correct output!")
click(Pattern("1460456062280.png").targetOffset(287,-224))

click("1460450493993.png")
sleep(1)
hover(Pattern("1460450548218.png").similar(0.91))
click(Pattern("1460459736270.png").similar(0.61))
wait("1460450592130.png", 5)
click(Pattern("1460450592130.png").targetOffset(-172,206))
click("1460450668056.png")
click("1460450698288.png")
if not exists("1460450769304.png", 15):
    print("[error] The custom indicator image was not uploaded as expected!")
    logging.error("[error] The custom indicator image was not uploaded as expected!")
    exit(1)
else:
    print("[success] The custom indicator image was successfully uploaded!")
    logging.info("[success] The custom indicator image was successfully uploaded!")
click("1460450769304.png")
click("1460450830055.png")
click("1460724919555.png")
if not exists(Pattern("1460450955231-1.png").similar(0.91), 15):
    print("[error] The custom indicator image was not added as expected!")
    logging.error("[error] The custom indicator image was not added as expected!")
    #exit(1)
else:
    print("[success] The custom indicator image was successfully added!")
    logging.info("[success] The custom indicator image was successfully added!")
if not exists(Pattern("1460451030070-1.png").similar(0.90), 15):
    print("[error] The custom indicator image did not appear on the top bar as expected!")
    logging.error("[error] The custom indicator image did not appear on the top bar as expected!")
    #exit(1)
else:
    print("[success] The custom indicator image appeared on the top bar as expected!")
    logging.info("[success] The custom indicator imappeared on the top bar as expected!")
click("1459780227625.png")
click("1459780248393.png")
wait(Pattern("1458740876103.png").targetOffset(-41,51), 5)
click(Pattern("1458740876103.png").targetOffset(-41,51))
if not exists("1459780227625.png", 5):
    print("[success] The project was saved and closed")
    logging.info("[success] The project was saved and closed")
else:
    print("[error] The project did not exit as expected!")
    logging.info("[error] The project did not exit as expected!")
    exit(1)

logging.info("=====Finished uploading first set of custom assets=====")

